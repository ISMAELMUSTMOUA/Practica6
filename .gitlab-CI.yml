# Imagen base (Contenedor Docker Ubuntu)
image: ubuntu:22.04

# Definimos las etapas (Stages)
stages:
  - build-and-test

# Variables para evitar que la instalaci√≥n de paquetes pregunte cosas (Timezone, etc)
variables:
  DEBIAN_FRONTEND: noninteractive

# --- EL TRABAJO PRINCIPAL ---
prueba_completa:
  stage: build-and-test
  
  # Instalar dependencias antes de empezar
  before_script:
    - apt-get update
    - apt-get install -y gcc make pkg-config libgtk-3-dev python3 python3-pip xvfb 
    - pip3 install pytest dogtail

  script:  
    
    # Compilar y limpiar
    - make clean
    - make all

    # Ejecutar tests
    - cd tests/
    - python3 generacion.py
    - python3 test_puntofijo.py
    - xvfb-run python3 test_GUI_basic.py
    - xvfb-run pytest test_GUI_dogtail.py     
